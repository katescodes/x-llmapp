端到端 Smoke 测试闸门设置完成
=====================================

创建日期: 2025-12-19
状态: ✅ 完成

已创建的文件和目录:
-------------------

1. 测试数据目录 (testdata/)
   ✅ testdata/tender_sample.pdf      # 招标文件样例 (767 KB)
   ✅ testdata/bid_sample.docx        # 投标文件样例 (33.6 MB)
   ✅ testdata/rules.yaml             # 自定义规则样例 (254 bytes)

2. Smoke 测试脚本 (scripts/smoke/)
   ✅ scripts/smoke/__init__.py       # 模块初始化
   ✅ scripts/smoke/tender_e2e.py     # 端到端测试主脚本 (16 KB, 可执行)
   ✅ scripts/smoke/README.md         # 详细文档 (9.8 KB)

3. Pytest 配置和测试 (backend/)
   ✅ backend/pytest.ini              # pytest 配置文件
   ✅ backend/tests/smoke/__init__.py # smoke 测试模块初始化
   ✅ backend/tests/smoke/test_tender_e2e.py  # pytest 封装

4. 前端集成 (frontend/)
   ✅ frontend/package.json           # 添加 smoke:tender 脚本

5. 文档
   ✅ SMOKE_TEST.md                   # 项目根目录快速指南

测试覆盖范围:
-------------
✅ 创建项目                         POST /api/apps/tender/projects
✅ 上传招标文件                     POST /api/apps/tender/projects/{id}/assets/import
✅ Step 1: 提取项目信息             POST /api/apps/tender/projects/{id}/extract/project-info
✅ Step 2: 识别风险                 POST /api/apps/tender/projects/{id}/extract/risks
✅ Step 3: 生成目录                 POST /api/apps/tender/projects/{id}/directory/generate
✅ Step 3.2: 自动填充样例 (可选)    POST /api/apps/tender/projects/{id}/directory/auto-fill-samples
✅ 上传格式模板 (可选)              POST /api/apps/tender/projects/{id}/directory/apply-format-template
✅ 上传投标文件                     POST /api/apps/tender/projects/{id}/assets/import
✅ Step 5: 运行审查                 POST /api/apps/tender/projects/{id}/review/run
✅ 导出 DOCX                        GET /api/apps/tender/projects/{id}/export/docx

运行方式:
---------

方式 1 - 直接运行 (推荐):
    cd /aidata/x-llmapp1
    python scripts/smoke/tender_e2e.py

方式 2 - 使用 pytest:
    cd /aidata/x-llmapp1/backend
    pytest -m smoke

方式 3 - 从前端运行:
    cd /aidata/x-llmapp1/frontend
    npm run smoke:tender

环境变量配置:
------------
BASE_URL              后端地址 (默认: http://localhost:9001)
USERNAME              用户名 (默认: admin@example.com)
PASSWORD              密码 (默认: admin123)
TENDER_FILE           招标文件路径 (默认: testdata/tender_sample.pdf)
BID_FILE              投标文件路径 (默认: testdata/bid_sample.docx)
SKIP_OPTIONAL         跳过可选步骤 (默认: false)
KEEP_PROJECT          保留测试项目 (默认: false)

验收标准 (Step 0):
-----------------
✅ docker compose up -d --build    # 服务启动成功
✅ python scripts/smoke/tender_e2e.py  # 测试通过，退出码 0
✅ pytest -m smoke                 # pytest 测试通过

注意事项:
--------
⚠️ 本测试不修改任何现有业务逻辑
⚠️ 只新增测试代码和入口
⚠️ 所有可选步骤支持跳过或失败不影响整体流程
⚠️ 测试依赖 LLM 服务，确保配置正确

下一步:
------
1. 启动服务: docker compose up -d --build
2. 运行测试: python scripts/smoke/tender_e2e.py
3. 如果通过，即可进入下一步开发
4. 如果失败，查看日志并修复问题

详细文档:
--------
- 快速指南: SMOKE_TEST.md
- 详细文档: scripts/smoke/README.md

=====================================
设置完成！现在可以运行测试了。
=====================================






