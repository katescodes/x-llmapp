# 技术参数抽取通用性提升方案

## 问题分析

不同项目的招标书技术参数差异巨大：
- **IT类**：CPU、内存、带宽、并发数、响应时间
- **工程类**：混凝土强度、钢材型号、施工工艺
- **设备类**：功率、转速、精度、防护等级
- **服务类**：人员资质、服务流程、响应时间

如果用固定模板，很容易遗漏或误判。

---

## 方案对比

### 方案1：增强语义理解 + 动态分类 ⭐⭐⭐⭐⭐（强烈推荐）

**核心思路**：让LLM理解"什么是技术要求"，而非匹配关键词

**优点**：
- ✅ 适应性最强，可处理任何行业
- ✅ 不需要维护行业词典
- ✅ 能识别新型技术要求
- ✅ 可以自动学习项目特征

**实现要点**：
1. 在Prompt中定义"技术参数"的语义边界（6大判断标准）
2. 鼓励模型自己创建合适的category
3. 提供跨行业示例，展示灵活性
4. 强调"宁可多提，不要遗漏"

**适用场景**：
- 项目类型多样化
- 预算充足（LLM调用成本）
- 追求高召回率

---

### 方案2：行业识别 + 动态Prompt ⭐⭐⭐⭐

**核心思路**：先识别项目行业，再加载对应的行业Prompt

**实现步骤**：
1. **Stage 0**（新增）：项目行业识别
   - 输入：招标文件标题、摘要
   - 输出：行业类型（IT/建筑/制造/服务/采购等）

2. **Stage 2**：根据行业类型注入不同的提示
   - IT项目：重点提示"软件配置、网络架构、安全要求"
   - 建筑项目：重点提示"材料规格、施工工艺、结构要求"
   - 制造项目：重点提示"设备参数、加工精度、质量标准"

**Prompt示例**：
```python
# 根据行业动态构建提示
industry_hints = {
    "IT": """
    重点关注：
    - 硬件配置（CPU、内存、存储、网络）
    - 软件要求（操作系统、数据库、中间件）
    - 性能指标（并发、响应时间、可用性）
    - 安全要求（认证、加密、审计）
    """,
    "建筑": """
    重点关注：
    - 材料规格（混凝土、钢材、装饰材料）
    - 结构要求（承重、抗震、防水）
    - 施工工艺（工序、方法、质量控制）
    - 验收标准（检测项目、合格标准）
    """,
    # ... 其他行业
}

# 在Stage 2中注入
context_info += f"\n\n行业提示：{industry_hints[industry]}"
```

**优点**：
- ✅ 针对性强，准确率高
- ✅ 可以控制提取重点
- ✅ 减少无关内容

**缺点**：
- ❌ 需要维护行业分类和提示
- ❌ 跨行业项目可能误判
- ❌ 新行业需要手动添加

---

### 方案3：检索增强 + 示例学习 ⭐⭐⭐⭐

**核心思路**：从历史项目中检索相似案例，作为few-shot示例

**实现步骤**：
1. 建立历史项目库，存储已标注的技术参数
2. 根据当前项目特征，检索3-5个最相似的历史案例
3. 将历史案例的技术参数作为示例注入Prompt

**示例**：
```
当前项目类似案例：

案例1：某医院信息化项目
技术参数示例：
- 服务器配置：CPU 16核，内存64GB
- 网络带宽：千兆以太网
- 数据库：Oracle 12c或以上
...

案例2：某学校弱电项目
技术参数示例：
- 综合布线：六类线缆
- 交换机：24口千兆交换机
...

请参考以上案例的抽取方式，从当前招标书中提取技术参数。
```

**优点**：
- ✅ 持续学习，越用越准
- ✅ 自动适应新行业
- ✅ 提供具体参考

**缺点**：
- ❌ 需要人工标注初始案例库
- ❌ 检索系统需要额外开发
- ❌ 冷启动问题

---

### 方案4：两阶段抽取（粗提取 + 精结构化）⭐⭐⭐

**核心思路**：先宽泛提取所有可能的技术内容，再结构化整理

**实现步骤**：

**Stage 2A**：粗提取（high recall）
```
任务：找出所有可能是技术要求的内容
要求：宁可多提，不要遗漏
输出：文本列表，每条包含内容和来源
```

**Stage 2B**：精结构化（high precision）
```
任务：将Stage 2A的内容结构化为标准格式
要求：识别name、value、category、unit
输出：标准的technical_parameters数组
```

**优点**：
- ✅ 分离召回和精确度优化
- ✅ 第一阶段简单快速
- ✅ 第二阶段可以迭代优化

**缺点**：
- ❌ 需要调用两次LLM
- ❌ 增加复杂度

---

### 方案5：混合策略（规则 + LLM）⭐⭐⭐

**核心思路**：用规则预筛选，用LLM精确提取

**实现步骤**：
1. **规则筛选**：用关键词快速定位可能的技术段落
   - 关键词：技术要求、技术参数、规格、标准、性能指标等
   - 章节：技术规范、货物清单、验收标准等

2. **LLM提取**：对筛选出的段落进行精确提取
   - 减少LLM处理的内容量
   - 提高准确率

**优点**：
- ✅ 效率高，成本低
- ✅ 规则可快速调整
- ✅ LLM聚焦关键内容

**缺点**：
- ❌ 可能漏掉特殊表述的技术要求
- ❌ 规则需要持续维护

---

## 综合推荐方案

### 🎯 短期方案（立即可用）

**采用方案1：增强语义理解 + 动态分类**

1. 更新Stage 2的Prompt（已准备好 `/tmp/stage2_enhanced.md`）
2. 重点改进：
   - 定义6大语义判断标准
   - 允许灵活创建category
   - 提供跨行业示例
   - 强调"宁可多提"

3. 测试验证：
   - 用3-5个不同行业的项目测试
   - 评估召回率（是否遗漏）和准确率（是否误提）
   - 根据反馈迭代优化

### 🚀 中期方案（1-2个月）

**方案1 + 方案3：增加历史案例学习**

1. 建立案例库
   - 收集10-20个典型项目
   - 人工标注优质的技术参数提取结果
   - 按行业/类型分类存储

2. 实现检索系统
   - 基于项目名称、描述进行相似度检索
   - 每次抽取时注入2-3个最相似案例

3. 持续优化
   - 每次抽取后，优质结果加入案例库
   - 定期review案例质量

### 🎨 长期方案（3-6个月）

**完整的自适应系统**

1. **项目画像**：自动识别项目特征
   - 行业、规模、复杂度
   - 技术密集度、参数类型

2. **动态Prompt生成**：
   - 根据项目画像自动生成最优Prompt
   - A/B测试不同Prompt效果

3. **质量反馈闭环**：
   - 用户标注（这个参数正确/错误/遗漏）
   - 自动调整抽取策略
   - 模型微调

---

## 立即行动方案

### 第1步：更新Prompt（30分钟）

```bash
# 1. 读取增强版Stage 2
cat /tmp/stage2_enhanced.md

# 2. 复制到数据库（替换原来的Stage 2部分）
# 通过界面：系统设置 → Prompt管理 → 项目信息提取 → 编辑
# 找到 "## Stage 2" 部分，替换为新内容

# 3. 保存并标注变更说明
变更说明：增强技术参数抽取的通用性和跨行业适应能力
```

### 第2步：测试验证（1-2小时）

准备测试项目（不同行业）：
1. IT类：软件系统采购
2. 工程类：建筑施工
3. 设备类：机械设备采购
4. 服务类：咨询服务

每个项目执行抽取，检查：
- 是否覆盖主要技术要求？
- 是否有明显的误提？
- category分类是否合理？

### 第3步：迭代优化（持续）

根据测试结果调整：
- 补充行业示例
- 优化判断标准
- 调整category指南

---

## 效果预期

### 当前版本（已有一定通用性）
- 召回率：~70%
- 准确率：~80%
- 适应性：中等

### 增强版本（方案1）
- 召回率：~85-90%
- 准确率：~85%
- 适应性：较强

### 完整方案（方案1+3）
- 召回率：~90-95%
- 准确率：~90%
- 适应性：强

---

## 附录：检查清单

评估技术参数抽取质量时，检查：

### 完整性（召回率）
- [ ] 是否覆盖了所有明显的技术指标？
- [ ] 是否包含了技术标准引用？
- [ ] 是否提取了工艺要求？
- [ ] 是否包含了测试验收条件？
- [ ] 是否包含了配置清单？

### 准确性（精确率）
- [ ] 提取的内容确实是技术要求吗？
- [ ] name和value是否对应正确？
- [ ] category分类是否合理？
- [ ] 是否有明显的商务条款混入？

### 可用性
- [ ] 结构化程度是否便于使用？
- [ ] parameters子数组是否有价值？
- [ ] evidence是否准确标注？

---

你更倾向于哪个方案？我可以帮你立即实施方案1，或者讨论其他方案的细节。

